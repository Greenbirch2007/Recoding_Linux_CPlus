

第一部分


简介和 TCP/IP




第一章  简介


1.1 概述


要编写通过计算机网络通信的程序，首先要确定这些程序相互通信所用的协议,
在深入设计一个协议的细节之前，应该从高层次决断通信由哪个程序发起以及响应在何时产生

一个认为web服务器程序是一个长时间运行的程序(所谓的守护程序)
它只在响应来自网络请求时才发送网络消息。

协议的另一端是web客户程序，如某种浏览器，
与服务器进程的通信总是由客户进程发起。


大多数网络应用就是按照划分成客户(client)和服务器(server)来组成的

在设计网络应用时，确定总是由客户发起请求往往能够简化协议和程序本身。

一些复杂的网络应用还需要异步回调(asynchronous callback)通信，
也就是由服务器向客户发起请求消息，


客户   <---------(应用协议)------->服务器


通常客户每次只与一个服务器通信，

从服务器的角度来看，一个服务器同时与多个客户通信很正常


可以认为客户与服务器之间是通过某个网络协议通信的，但实际上，这样的通信通常
涉及多个网络协议层。

本书的焦点是TCP/IP协议族，也称为国际协议族。

举例来说，web客户与服务器之间实用TCP(传输控制协议)通信。TCP又转而实用IP(国际协议)通信，
IP再通过某种形式的数据链路层通信。

如果客户和服务器处于同一个以太网


unix系统中程序(program)和进程(process)是在系统调用exec上链接的。

客户进程和迭代服务器程序运行时通常只有一个进程，并发服务器程序运行时除主进程外，
通常还为每个客户派生一个进程，程序和进程的密切关系使得两者有时相互渗透实使用，不易区分


尽管客户与服务器之间使用某个应用协议通信，传输层却实用TCP通信。

注意，客户与服务器之间的通信的信息流在其中一端是向下通过协议栈的，跨越网络后，在另一端则是
向上通过协议栈的、

客户和服务器通常是用户进程，而TCP和IP协议通常是内核中协议栈的一部分

本书讨论的协议不限于TCP,IP

客户与服务器使用TCP在同一个以太网中通信

同一网络应用的客户和服务器无需处于同一个局域网

处于不同局域网中的客户和服务器，而这两个局域网是使用路由器连接到广域网的


处于不同局域网的客户主机和服务器主机通过广域网连接


路由器是广域网的架构设备。当今最大的广域网是因特网。

许多公司也构建自己的广域网，而这些私用的广域网既可以连接到因特网，也可以不连接

我们对本书中要调用的大多数系统函数定义了各自的包裹函数。
多数情况下我们可以使用包裹函数来检查错误，输出适当的消息，
以及在出错时终止程序的运行。

我们还给出了本书中大多数例子所用的测试网络，主机，路由器以及它们的主机名，IP地址
和操作系统


POSIX是一种被多数厂商采纳的标准


1.2  一个简单的时间获取客户程序

TCP时间获取客户程序

